![image](https://user-images.githubusercontent.com/79595418/199066075-35556f4c-8ae6-4d7a-ac06-6c4e696f45f0.png)

итак
ДАНО: файл с расширением ехе.
1) ПЕРВЫМ ДЕЛОМ: чекаем file'ом что за файл вообще.

![image](https://user-images.githubusercontent.com/79595418/199067039-a1c89978-85c5-4e00-a478-61033bfbb9ce.png)

так, видим .Net.
далеко не уходя смотрим strings

![image](https://user-images.githubusercontent.com/79595418/199067339-8fd42520-b7f7-44f4-8031-b3a41a0fcfb7.png)

пока ниче не понятно, идём дальше.

2) для ревёрса .Net юзаем dnSpy, подтягиваем с гита, устанавливаем, грузим файл, смотрим:

![image](https://user-images.githubusercontent.com/79595418/199067617-295ed14f-e720-4816-a965-54e4dc6a1f1a.png)

немного полазив обнаруживаем, что более-менее читаемый код содержит в себе класс А с подклассами a, A, b, B.

![image](https://user-images.githubusercontent.com/79595418/199068450-3ace774f-56de-4549-83de-f32e002babdc.png)

из кода понятно следующее: что-то вводится, что-то выводится, две переменные flag (наш логин) и flag2 (пароль), в первой какая-то простая эквивалентная операция, а во второй сравнение двух строк по их длине, из чего потом следует вывод класса А.А.С.

3) ДЕБАЖИМ: короче, дебажим да. жмём старт и выбираем "остановиться в точке входа".

![image](https://user-images.githubusercontent.com/79595418/199069513-9e1323c5-153e-433e-b2ef-a351ccd29038.png)

входим в режим отладки, открылась cmd и тулза подсветила место где мы находимся.
для навигации по коду юзаем две стрелки: 1 - шаг с заходом, 2 - шаг с обходом.

входим внутрь а.А, попадаем в главную функцию, ещё шаг, пока ничего не происходит, ещё шаг, дебаггер стопится на строке Console.Readline() - тобишь программа ожидает строку на ввод, нас переключает на cmd и видим вывод сообщения:

![image](https://user-images.githubusercontent.com/79595418/199070065-381fdea2-a0a5-4d6f-9674-5be9dd2a7478.png)

логина мы не знаем, вводим любой текст > enter, снова шаг с обходом.

![image](https://user-images.githubusercontent.com/79595418/199070423-71a2f8ba-2f2b-456d-8ede-8771d40fe595.png)

обратим внимание ниже на окно локальные переменные, здесь мы видим, что введённое нами значение возвращено, а также в программе уже инициализированы две переменные flag и flag2, понаблюдаем за их значениями, жмём шаг с обходом.

снова Console.Readline() и нас просит ввести пароль, действуем аналогично. затем жмём шаг с обходом и попадаем на строку, где булевой переменной flag присваивается значение b.A и оно же равно B.A (глобальной переменной).
далее видим, что программа отобразила как раз присваиваемое переменной flag значение: "cat-the-mayor", это и есть валидный логин.

![image](https://user-images.githubusercontent.com/79595418/199071479-93a928a9-6a8f-4c4c-8bac-6a7d0c37496a.png)

поскольку мы теперь знаем логин, перезапустим прогу и введём правильный логин, повторяя все шаги в точности как выше. видим, что теперь на шаге if (flag) переменная flag имеет значение True.

![image](https://user-images.githubusercontent.com/79595418/199072277-78bc58ef-7e47-4e54-8c1c-a3bdd637733c.png)

шаг с обходом, попадаем внутрь первого-внешнего условия, где проверяется первая переменная.
ещё шаг и останавливаемся на строке bool flag2 = B.A(b.A.Length, b.a.Length); - тут что-то происходит с flag2, интересно что, делаем шаг со входом, посмотрим.

![image](https://user-images.githubusercontent.com/79595418/199073242-d5e2ba77-d38d-464d-85cd-e1b0dc0a970c.png)

попадаем в класс B и немного пролистав код класса, видим понятные арифметические операции, осталось разобраться над какими переменными.
шагаем несколько раз с обходом, наблюдая в окне локальных переменных за изменением их значений.

![image](https://user-images.githubusercontent.com/79595418/199074454-f5dd311e-8183-4607-ac6e-bbce068b29f6.png)

что мы видим здесь: это подробная версия кода, которого мы наблюдали ранее. здесь, как и там, сначала инициализируются какие-то целочисленные переменные (num, num2, num3, num4)

присваиваются значения булевым переменным flag (38 строка) и flag2 (55 строка). 
с flag всё понятно, смотрим на строку 55, где flag2

![image](https://user-images.githubusercontent.com/79595418/199075076-21d8e86f-f977-4fd9-b973-f91065e6cb8f.png)

видим, что flag2 примет значение True, когда будет выполнено условие, что остаток от деления А_1 на num2 будет равен num4. 
на скрине выше, в окне локальных переменных видно, что первое value (A_0) имеет значение 13, второе (A_1) равно 8. это длины введённых нами логина (cat-the-mayor) и пароля (anytext2).
также там значения num'ов.

4) КОРОЧЕ ЯСНО: становится понятно, что программа берёт длину пароля (А_1) проходит цикл do-while с арифметическими вычислениями и затем из получивших значений проводит вычисление: A1 % num2 = num4, если всё ок, то получим flag2 = True, иначе получим false и <s>пойдем нахер</s> прога закроется.
пройдемся по циклу, чтобы понять насколько он изменяет нашу длину. итак, было 8 (A_1), шагаем с обходом до num3=16:

![image](https://user-images.githubusercontent.com/79595418/199077262-16767b85-3786-4376-946b-fb3df80a5764.png)

value2 стало 12448, делаем вывод, что нашей длине прибавляется 12440. ок, дальше прога подставляет 12448 в пример: 12448 %  126 = 108. поскольку вычисление неверно, в flag2 возвращается результат false.

перед тем как перезапускать прогу, подберём близкие значения, при которых мы получим true.

![image](https://user-images.githubusercontent.com/79595418/199080969-29cadd08-4634-4364-a7f0-fafc1889e691.png)

итак, когда прога после 16 цикла в A_1 получит какое-либо значение из левого столбца (значение а - любое целое число около 12440) - то мы получим флаг. интересно число 12456, 
следуя логике выше - при длине пароля 16 симвмолов программа прибавит 12440 и мы получим валидное число, что приведёт нас к flag2 = True, попробуем. 
проходимснова путь в дебаггере и на 16 цикле видим: 

![image](https://user-images.githubusercontent.com/79595418/199081682-9429ac2a-86e8-420b-8a2b-4a16985c3ce8.png)

кайф, да. идём дальше, проходим все условия на True и получаем флаг.
mctf{meow-m3ow-m30w-M#)W}

![image](https://user-images.githubusercontent.com/79595418/199081816-0443146e-8aea-42ca-9e3e-c5dddb9b1690.png)

давай пока!







